<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="The package mfair implements the methods based on the MFAI paper, which integrate gradient boosted trees in the probabilistic matrix factorization framework to effectively leverage auxiliary information.">
<title>Matrix Factorization with Auxiliary Information in R â€¢ mfair</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Matrix Factorization with Auxiliary Information in R">
<meta property="og:description" content="The package mfair implements the methods based on the MFAI paper, which integrate gradient boosted trees in the probabilistic matrix factorization framework to effectively leverage auxiliary information.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">mfair</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/ml100k.html">Enrichment of movie genre information</a>
    <a class="dropdown-item" href="articles/neocortex.html">Spatial and temporal dynamics of gene regulation among brain tissues</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/YangLabHKUST/mfair/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="mfair-matrix-factorization-with-auxiliary-information-in-r">mfair: Matrix Factorization with Auxiliary Information in R<a class="anchor" aria-label="anchor" href="#mfair-matrix-factorization-with-auxiliary-information-in-r"></a>
</h1></div>
<!-- badges: start -->

<p>The R package <code>mfair</code> implements the methods based on the paper <a href="https://doi.org/10.48550/arXiv.2303.02566" class="external-link">MFAI: A scalable Bayesian matrix factorization approach to leveraging auxiliary information</a>. MFAI integrates gradient boosted trees in the probabilistic matrix factorization framework to effectively leverage auxiliary information. The parameters in MAFI can be automatically determined under the empirical Bayes framework, making it adaptive to the utilization of auxiliary information and immune to overfitting.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>mfair</code> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"YangLabHKUST/mfair"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Please note that it can take several minutes to build the vignettes.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<ul>
<li>This is a basic example which shows you how to solve a common problem:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20230306</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yanglabhkust.github.io/mfair/">mfair</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: rpart</span></span>
<span></span>
<span><span class="co"># Simulate data</span></span>
<span><span class="co"># Set the data dimension and rank</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">K_true</span> <span class="op">&lt;-</span> <span class="fl">2L</span></span>
<span></span>
<span><span class="co"># Set the proportion of variance explained (PVE)</span></span>
<span><span class="va">PVE_Z</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="va">PVE_Y</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Generate auxiliary information X</span></span>
<span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># F(X)</span></span>
<span><span class="va">FX1</span> <span class="op">&lt;-</span> <span class="va">X1</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">X2</span></span>
<span><span class="va">FX2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">X1</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="va">X2</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">X1</span> <span class="op">*</span> <span class="va">X2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span></span>
<span><span class="va">FX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">FX1</span>, <span class="va">FX2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate loadings Z (= F(X) + noise)</span></span>
<span><span class="va">sig1_sq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">FX1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">PVE_Z</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Z1</span> <span class="op">&lt;-</span> <span class="va">FX1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sig1_sq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sig2_sq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">FX2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">PVE_Z</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Z2</span> <span class="op">&lt;-</span> <span class="va">FX2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sig2_sq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Z1</span>, <span class="va">Z2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate factors W</span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">M</span> <span class="op">*</span> <span class="va">K_true</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">M</span>, ncol <span class="op">=</span> <span class="va">K_true</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate the main data matrix Y_obs (= Y + noise)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">Z</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span></span>
<span><span class="va">Y_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">epsilon_sq</span> <span class="op">&lt;-</span> <span class="va">Y_var</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">PVE_Y</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y_obs</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">M</span>,</span>
<span>    mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">epsilon_sq</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">N</span>, ncol <span class="op">=</span> <span class="va">M</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create MFAIR object</span></span>
<span><span class="va">mfairObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createMFAIR.html">createMFAIR</a></span><span class="op">(</span><span class="va">Y_obs</span>, <span class="va">X</span>, K_max <span class="op">=</span> <span class="va">K_true</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the MFAI model</span></span>
<span><span class="va">mfairObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fitGreedy.html">fitGreedy</a></span><span class="op">(</span><span class="va">mfairObject</span>, sf_para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose_loop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Set K_max = 2!</span></span>
<span><span class="co">#&gt; Initialize the parameters of factor 1......</span></span>
<span><span class="co">#&gt; After 1 iterations Stage 1 ends!</span></span>
<span><span class="co">#&gt; After 43 iterations Stage 2 ends!</span></span>
<span><span class="co">#&gt; Factor 1 retained!</span></span>
<span><span class="co">#&gt; Initialize the parameters of factor 2......</span></span>
<span><span class="co">#&gt; After 1 iterations Stage 1 ends!</span></span>
<span><span class="co">#&gt; After 40 iterations Stage 2 ends!</span></span>
<span><span class="co">#&gt; Factor 2 retained!</span></span>
<span></span>
<span><span class="co"># Prediction based on the low-rank approximation</span></span>
<span><span class="va">Y_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mfairObject</span><span class="op">)</span></span>
<span><span class="co">#&gt; The main data matrix Y has no missing entries!</span></span>
<span></span>
<span><span class="co"># Root-mean-square-error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">Y_obs</span> <span class="op">-</span> <span class="va">Y_hat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12.22526</span></span>
<span></span>
<span><span class="co"># Predicted/true matrix variance ratio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_obs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.471485</span></span>
<span></span>
<span><span class="co"># Prediction/noise variance ratio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_obs</span> <span class="op">-</span> <span class="va">Y_hat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9884637</span></span></code></pre></div>
<ul>
<li>
<code>mfair</code> can also handle the matrix with missing entries:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Split the data into the training set and test set</span></span>
<span><span class="va">n_all</span> <span class="op">&lt;-</span> <span class="va">N</span> <span class="op">*</span> <span class="va">M</span></span>
<span><span class="va">training_ratio</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">train_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_all</span>, <span class="va">n_all</span> <span class="op">*</span> <span class="va">training_ratio</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Y_train</span> <span class="op">&lt;-</span> <span class="va">Y_test</span> <span class="op">&lt;-</span> <span class="va">Y_obs</span></span>
<span><span class="va">Y_train</span><span class="op">[</span><span class="op">-</span><span class="va">train_set</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">Y_test</span><span class="op">[</span><span class="va">train_set</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># Create MFAIR object</span></span>
<span><span class="va">mfairObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createMFAIR.html">createMFAIR</a></span><span class="op">(</span><span class="va">Y_train</span>, <span class="va">X</span>, K_max <span class="op">=</span> <span class="va">K_true</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the MFAI model</span></span>
<span><span class="va">mfairObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fitGreedy.html">fitGreedy</a></span><span class="op">(</span><span class="va">mfairObject</span>, sf_para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose_loop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Set K_max = 2!</span></span>
<span><span class="co">#&gt; Initialize the parameters of factor 1......</span></span>
<span><span class="co">#&gt; After 1 iterations Stage 1 ends!</span></span>
<span><span class="co">#&gt; After 68 iterations Stage 2 ends!</span></span>
<span><span class="co">#&gt; Factor 1 retained!</span></span>
<span><span class="co">#&gt; Initialize the parameters of factor 2......</span></span>
<span><span class="co">#&gt; After 1 iterations Stage 1 ends!</span></span>
<span><span class="co">#&gt; After 66 iterations Stage 2 ends!</span></span>
<span><span class="co">#&gt; Factor 2 retained!</span></span>
<span></span>
<span><span class="co"># Prediction based on the low-rank approximation</span></span>
<span><span class="va">Y_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mfairObject</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Root-mean-square-error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">Y_test</span> <span class="op">-</span> <span class="va">Y_hat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12.88825</span></span>
<span></span>
<span><span class="co"># Predicted/true matrix variance ratio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_hat</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_obs</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4311948</span></span>
<span></span>
<span><span class="co"># Prediction/noise variance ratio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_hat</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_obs</span> <span class="op">-</span> <span class="va">Y_hat</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8554015</span></span></code></pre></div>
<ul>
<li>Empirically, the backfitting algorithm can further improve the performance:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Refine the MFAI model with the backfitting algorithm</span></span>
<span><span class="va">mfairObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fitBack.html">fitBack</a></span><span class="op">(</span><span class="va">mfairObject</span>,</span>
<span>  verbose_bf_inner <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sf_para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose_sf <span class="op">=</span> <span class="cn">FALSE</span>, verbose_loop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Iteration: 1, relative difference of model parameters: 0.2212487.</span></span>
<span><span class="co">#&gt; Iteration: 2, relative difference of model parameters: 0.05861598.</span></span>
<span><span class="co">#&gt; Iteration: 3, relative difference of model parameters: 0.01781071.</span></span>
<span><span class="co">#&gt; Iteration: 4, relative difference of model parameters: 0.02649139.</span></span>
<span><span class="co">#&gt; Iteration: 5, relative difference of model parameters: 0.01830385.</span></span>
<span><span class="co">#&gt; Iteration: 6, relative difference of model parameters: 0.007152868.</span></span>
<span></span>
<span><span class="co"># Prediction based on the low-rank approximation</span></span>
<span><span class="va">Y_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mfairObject</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Root-mean-square-error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">Y_test</span> <span class="op">-</span> <span class="va">Y_hat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12.84545</span></span>
<span></span>
<span><span class="co"># Predicted/true matrix variance ratio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_hat</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_obs</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4434191</span></span>
<span></span>
<span><span class="co"># Prediction/noise variance ratio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_hat</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Y_obs</span> <span class="op">-</span> <span class="va">Y_hat</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8846744</span></span></code></pre></div>
<ul>
<li>Explore the <a href="https://yanglabhkust.github.io/mfair/articles/ml100k.html">vignette illustrating the enrichment of the movie genre information</a>:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"ml100k"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Explore the <a href="https://yanglabhkust.github.io/mfair/articles/neocortex.html">vignette illustrating the spatial and temporal dynamics of gene regulation among brain tissues</a>:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"neocortex"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>For more documentation and examples, please visit our package <a href="https://yanglabhkust.github.io/mfair/">website</a>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="citing-our-work">Citing our work<a class="anchor" aria-label="anchor" href="#citing-our-work"></a>
</h2>
<p>If you find the <code>mfair</code> package or any of the source code in this repository useful for your work, please cite:</p>
<blockquote>
<p>Wang, Z., Zhang, F., Zheng, C., Hu, X., Cai, M., and Yang, C. (2023). MFAI: A scalable Bayesian matrix factorization approach to leveraging auxiliary information. arXiv preprint arXiv:2303.02566. URL: <a href="https://doi.org/10.48550/arXiv.2303.02566" class="external-link uri">https://doi.org/10.48550/arXiv.2303.02566</a>.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="development">Development<a class="anchor" aria-label="anchor" href="#development"></a>
</h2>
<p>The package is developed by Zhiwei Wang (<a href="mailto:zhiwei.wang@connect.ust.hk" class="email">zhiwei.wang@connect.ust.hk</a>).</p>
</div>
<div class="section level2">
<h2 id="contact-information">Contact Information<a class="anchor" aria-label="anchor" href="#contact-information"></a>
</h2>
<p>Please feel free to contact Zhiwei Wang (<a href="mailto:zhiwei.wang@connect.ust.hk" class="email">zhiwei.wang@connect.ust.hk</a>), Prof.Â Mingxuan Cai (<a href="mailto:mingxcai@cityu.edu.hk" class="email">mingxcai@cityu.edu.hk</a>), or Prof.Â Can Yang (<a href="mailto:macyang@ust.hk" class="email">macyang@ust.hk</a>) if any inquiries.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/YangLabHKUST/mfair/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/YangLabHKUST/mfair/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mfair</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Zhiwei Wang <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7682-0070" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://app.codecov.io/gh/YangLabHKUST/mfair?branch=main" class="external-link"><img src="https://codecov.io/gh/YangLabHKUST/mfair/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/YangLabHKUST/mfair/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/YangLabHKUST/mfair/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Zhiwei Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
